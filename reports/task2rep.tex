
\documentclass[11pt,a4paper]{article}
\usepackage{listings}
\usepackage{hyperref}
\usepackage[utf8x]{inputenc}
\usepackage[russian]{babel}
\usepackage{dirtytalk}
\usepackage{geometry}
\geometry{verbose,a4paper,tmargin=2cm,bmargin=2cm,lmargin=2cm,rmargin=1.5cm}
\title{Project Euler Task 2}
\author{Козиний Сергей}
\begin{document}    
\maketitle
\href{''https://projecteuler.net/problem=2''}{Problem 2}

\say{ Each new term in the Fibonacci sequence is generated by adding the previous two terms. By starting with 1 and 2, the first 10 terms will be:

1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...

By considering the terms in the Fibonacci sequence whose values do not exceed four million, find the sum of the even-valued terms.
}\\

Для решения задачи, в первую очередь необходимо написать процедуру, быстро генерирующую последовательность чисел Фибоначчи. Воспользуемся для этого функцией $unfoldr \quad f \quad seed \quad seq$ из пакета $Data.List$:

$unfoldr :: (b -> Maybe (a, b)) -> b -> [a] $,
которая по заданному зерну $seed$ типа $b$ воссоздает последовательность элементов $seq$ типа $a$ с помощью функции $func$ типа  $b -> Maybe (a, b)$, где на каждом шаге, правый элемент вычисляемой пары, обернутой в монаду $Maybe$ включается в результирующий список (если $Maybe(a,b)$ принимает значение $Nothing$, список обрывается и вычисление заканчивается), а левый - служит аргументом для $func$ на следующем шаге итерации. 

Вот как будет выглядеть последовательность чисел Фибоначчи в терминах $unfoldr$

\begin{lstlisting}[language=Haskell, frame=single]
  --Haskell lang
import qualified Data.List as List
fibs = List.unfoldr (\(a,b) -> Just (a,(b,a+b))) (0,1)  
\end{lstlisting}
Затраты на вычисление каждого следующего элемента списка можно оценить как  $O(1)$ по времени и памяти.

Теперь, для того чтобы вычислить сумму всех чётных чисел Фибоначчи до 4000000 напишем следующую функцию.
\begin{lstlisting}[language=Haskell, frame=single]
  --Haskell lang
task2 = sum $ filter isEven $ takeWhile (<4000000) fibs 
    where fibs = List.unfoldr (\(a,b) -> Just (a,(b,a+b))) (0,1)
          isEven x = x `mod` 2 ==0
\end{lstlisting}

Результат:

\begin{lstlisting}[frame=single]
#Console
austrotaxus@small-box:~/EulerProj$ stack ghci
Using main module: Package `EulerProj' component exe:EulerProj-exe
with main-is file: /home/austrotaxus/EulerProj/app/Main.hs
The following GHC options are incompatible with GHCi and have not
been passed to it: -threaded
Configuring GHCi with the following packages: EulerProj
GHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help
[1 of 2] Compiling Lib
( /home/austrotaxus/EulerProj/src/Lib.hs, interpreted )
[2 of 2] Compiling Main
( /home/austrotaxus/EulerProj/app/Main.hs, interpreted )
Ok, modules loaded: Lib, Main. 
*Main Lib> task2
4613732
\end{lstlisting}


\end{document}
